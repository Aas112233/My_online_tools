<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PDF Tools - My Online Tools</title>
    <link rel="stylesheet" href="css/styles.css">
    <link href="http://maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.4.120/pdf.min.js"></script>
</head>
<body>
    <nav class="top-nav">
        <div class="nav-brand">
            <h2>My Online Tools</h2>
        </div>
        <ul class="nav-menu">
            <li class="nav-item">
                <a href="calculator.html" class="nav-link" id="calculator-link">Scientific Calculator</a>
            </li>
            <li class="nav-item">
                <a href="barcode.html" class="nav-link" id="barcode-link">Barcode & QR Code</a>
            </li>
            <li class="nav-item">
                <a href="index.html" class="nav-link active" id="pdf-link">PDF Tools</a>
            </li>
            <li class="nav-item">
                <a href="design-qr.html" class="nav-link" id="design-qr-link">Design QR Code</a>
            </li>
            <li class="nav-item">
                <a href="extra.html" class="nav-link" id="extra-link">Extra Tools</a>
            </li>
        </ul>
    </nav>
    
    <div class="content-container">
        <div class="tool-section">
            <h2>PDF Tools</h2>
            <p>Process your PDF documents with these online tools. All processing happens in your browser - your files never leave your computer.</p>
            
            <div class="pdf-tools-container">
                <div class="tool-selector">
                    <label for="tool-select">Select a tool:</label>
                    <select id="tool-select" class="form-control">
                        <option value="merge">Merge PDFs</option>
                        <option value="split">Split PDF</option>
                        <option value="compress">Compress PDF</option>
                        <option value="remove-pages">Remove Pages</option>
                        <option value="rotate">Rotate Pages</option>
                        <option value="add-watermark">Add Watermark</option>
                    </select>
                </div>
                
                <div class="tool-description">
                    <p id="tool-description">Merge multiple PDF files into one document.</p>
                </div>
                
                <div class="file-upload-area">
                    <div class="file-drop-area" id="drop-area">
                        <p>Drag & drop your PDF files here or click to browse</p>
                        <input type="file" id="file-input" accept=".pdf" multiple>
                        <button class="btn btn-primary" id="browse-btn">Browse Files</button>
                    </div>
                    
                    <div class="file-list" id="file-list">
                        <!-- Files will be listed here -->
                    </div>
                </div>
                
                <div class="tool-options" id="tool-options">
                    <!-- Tool-specific options will appear here -->
                </div>
                
                <div class="action-buttons">
                    <button class="btn btn-secondary" id="reset-btn">Reset</button>
                    <button class="btn btn-primary" id="process-btn">Process PDF</button>
                </div>
                
                <div class="result-area" id="result-area" style="display: none;">
                    <h3>Processing Complete</h3>
                    <p>Your PDF has been processed successfully.</p>
                    <button class="btn btn-primary" id="download-btn">Download Result</button>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        // Set up PDF.js worker
        pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.4.120/pdf.worker.min.js';
        
        // Tool descriptions
        const toolDescriptions = {
            'merge': 'Merge multiple PDF files into one document.',
            'split': 'Split a PDF document into multiple files.',
            'compress': 'Reduce the file size of your PDF.',
            'remove-pages': 'Remove specific pages from your PDF.',
            'rotate': 'Rotate pages in your PDF document.',
            'add-watermark': 'Add a text watermark to your PDF.'
        };
        
        // DOM elements
        const toolSelect = document.getElementById('tool-select');
        const toolDescription = document.getElementById('tool-description');
        const dropArea = document.getElementById('drop-area');
        const fileInput = document.getElementById('file-input');
        const browseBtn = document.getElementById('browse-btn');
        const fileList = document.getElementById('file-list');
        const toolOptions = document.getElementById('tool-options');
        const resetBtn = document.getElementById('reset-btn');
        const processBtn = document.getElementById('process-btn');
        const resultArea = document.getElementById('result-area');
        const downloadBtn = document.getElementById('download-btn');
        
        // Event listeners
        toolSelect.addEventListener('change', updateToolDescription);
        browseBtn.addEventListener('click', () => fileInput.click());
        fileInput.addEventListener('change', handleFileSelect);
        resetBtn.addEventListener('click', resetTool);
        processBtn.addEventListener('click', processPDF);
        
        // Initialize
        updateToolDescription();
        
        // Functions
        function updateToolDescription() {
            const selectedTool = toolSelect.value;
            toolDescription.textContent = toolDescriptions[selectedTool];
            updateToolOptions(selectedTool);
        }
        
        function updateToolOptions(tool) {
            toolOptions.innerHTML = '';
            
            switch(tool) {
                case 'split':
                    toolOptions.innerHTML = `
                        <div class="form-group">
                            <label for="split-page">Split at page:</label>
                            <input type="number" id="split-page" class="form-control" min="1" value="1">
                        </div>
                    `;
                    break;
                    
                case 'remove-pages':
                    toolOptions.innerHTML = `
                        <div class="form-group">
                            <label for="pages-to-remove">Pages to remove (comma separated):</label>
                            <input type="text" id="pages-to-remove" class="form-control" placeholder="e.g., 1, 3, 5-7">
                        </div>
                    `;
                    break;
                    
                case 'rotate':
                    toolOptions.innerHTML = `
                        <div class="form-group">
                            <label for="rotate-degrees">Rotation:</label>
                            <select id="rotate-degrees" class="form-control">
                                <option value="90">90째 Clockwise</option>
                                <option value="180">180째</option>
                                <option value="270">90째 Counterclockwise</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="rotate-pages">Pages (comma separated, empty for all):</label>
                            <input type="text" id="rotate-pages" class="form-control" placeholder="e.g., 1, 3, 5-7">
                        </div>
                    `;
                    break;
                    
                case 'add-watermark':
                    toolOptions.innerHTML = `
                        <div class="form-group">
                            <label for="watermark-text">Watermark Text:</label>
                            <input type="text" id="watermark-text" class="form-control" placeholder="CONFIDENTIAL">
                        </div>
                        <div class="form-group">
                            <label for="watermark-opacity">Opacity:</label>
                            <input type="range" id="watermark-opacity" class="form-control" min="0.1" max="1" step="0.1" value="0.5">
                        </div>
                    `;
                    break;
            }
        }
        
        function handleFileSelect(e) {
            const files = e.target.files;
            displayFiles(files);
        }
        
        function displayFiles(files) {
            fileList.innerHTML = '';
            for (let i = 0; i < files.length; i++) {
                const file = files[i];
                const fileItem = document.createElement('div');
                fileItem.className = 'file-item';
                fileItem.innerHTML = `
                    <span class="file-name">${file.name}</span>
                    <span class="file-size">(${formatFileSize(file.size)})</span>
                `;
                fileList.appendChild(fileItem);
            }
        }
        
        function formatFileSize(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }
        
        function resetTool() {
            fileInput.value = '';
            fileList.innerHTML = '';
            resultArea.style.display = 'none';
        }
        
        function processPDF() {
            if (!fileInput.files.length) {
                alert('Please select at least one PDF file.');
                return;
            }
            
            const selectedTool = toolSelect.value;
            const file = fileInput.files[0];
            
            // Show processing message
            resultArea.innerHTML = '<p>Processing your PDF... Please wait.</p>';
            resultArea.style.display = 'block';
            
            // Read the PDF file
            const reader = new FileReader();
            reader.onload = function(e) {
                const typedarray = new Uint8Array(e.target.result);
                
                switch(selectedTool) {
                    case 'merge':
                        // For merge, we would need multiple files
                        // This is a simplified version that just processes the first file
                        processMergePDF(typedarray);
                        break;
                    case 'split':
                        processSplitPDF(typedarray);
                        break;
                    case 'compress':
                        processCompressPDF(typedarray);
                        break;
                    case 'remove-pages':
                        processRemovePagesPDF(typedarray);
                        break;
                    case 'rotate':
                        processRotatePDF(typedarray);
                        break;
                    case 'add-watermark':
                        processWatermarkPDF(typedarray);
                        break;
                    default:
                        alert('Selected tool not implemented yet.');
                }
            };
            reader.readAsArrayBuffer(file);
        }
        
        // Merge PDFs function (simplified)
        function processMergePDF(typedarray) {
            // In a full implementation, this would merge multiple PDFs
            // For now, we'll just show a message
            resultArea.innerHTML = `
                <h3>Merge PDF</h3>
                <p>In a complete implementation, this would merge multiple PDF files into one document.</p>
                <p><strong>Note:</strong> Actual PDF merging requires combining multiple PDF documents, 
                which would need additional implementation using PDF.js or a similar library.</p>
                <button class="btn btn-primary" onclick="resetTool()">Process Another PDF</button>
            `;
        }
        
        // Split PDF function
        function processSplitPDF(typedarray) {
            // Load the PDF document
            pdfjsLib.getDocument(typedarray).promise.then(function(pdf) {
                const splitPage = document.getElementById('split-page') ? 
                    parseInt(document.getElementById('split-page').value) : 1;
                
                resultArea.innerHTML = `
                    <h3>Split PDF</h3>
                    <p>Your PDF has ${pdf.numPages} pages.</p>
                    <p>In a complete implementation, this would split your PDF into two documents:</p>
                    <ol>
                        <li>Pages 1 to ${Math.min(splitPage, pdf.numPages)}</li>
                        <li>Pages ${splitPage + 1} to ${pdf.numPages}</li>
                    </ol>
                    <p><strong>Note:</strong> Actual PDF splitting requires creating new PDF documents 
                    with selected pages, which would need additional implementation using PDF.js.</p>
                    <button class="btn btn-primary" onclick="resetTool()">Process Another PDF</button>
                `;
            }).catch(function(error) {
                console.error('Error loading PDF:', error);
                resultArea.innerHTML = `
                    <h3>Error</h3>
                    <p>There was an error processing your PDF: ${error.message}</p>
                    <button class="btn btn-primary" onclick="resetTool()">Try Again</button>
                `;
            });
        }
        
        // Compress PDF function
        function processCompressPDF(typedarray) {
            // Load the PDF document
            pdfjsLib.getDocument(typedarray).promise.then(function(pdf) {
                resultArea.innerHTML = `
                    <h3>Compress PDF</h3>
                    <p>Your PDF has ${pdf.numPages} pages.</p>
                    <p>In a complete implementation, this would compress your PDF by:</p>
                    <ul>
                        <li>Optimizing images</li>
                        <li>Removing unnecessary objects</li>
                        <li>Compressing streams</li>
                        <li>Downsampling images</li>
                    </ul>
                    <p><strong>Note:</strong> Actual PDF compression requires reprocessing the PDF content 
                    and applying compression algorithms, which would need additional implementation.</p>
                    <button class="btn btn-primary" onclick="resetTool()">Process Another PDF</button>
                `;
            }).catch(function(error) {
                console.error('Error loading PDF:', error);
                resultArea.innerHTML = `
                    <h3>Error</h3>
                    <p>There was an error processing your PDF: ${error.message}</p>
                    <button class="btn btn-primary" onclick="resetTool()">Try Again</button>
                `;
            });
        }
        
        // Remove pages function
        function processRemovePagesPDF(typedarray) {
            // Load the PDF document
            pdfjsLib.getDocument(typedarray).promise.then(function(pdf) {
                const pagesToRemove = document.getElementById('pages-to-remove') ? 
                    document.getElementById('pages-to-remove').value : '';
                
                resultArea.innerHTML = `
                    <h3>Remove Pages</h3>
                    <p>Your PDF has ${pdf.numPages} pages.</p>
                    <p>Pages to remove: ${pagesToRemove || 'None specified'}</p>
                    <p>In a complete implementation, this would create a new PDF without the specified pages.</p>
                    <p><strong>Note:</strong> Actual page removal requires creating a new PDF document 
                    with only the desired pages, which would need additional implementation using PDF.js.</p>
                    <button class="btn btn-primary" onclick="resetTool()">Process Another PDF</button>
                `;
            }).catch(function(error) {
                console.error('Error loading PDF:', error);
                resultArea.innerHTML = `
                    <h3>Error</h3>
                    <p>There was an error processing your PDF: ${error.message}</p>
                    <button class="btn btn-primary" onclick="resetTool()">Try Again</button>
                `;
            });
        }
        
        // Rotate pages function
        function processRotatePDF(typedarray) {
            // Load the PDF document
            pdfjsLib.getDocument(typedarray).promise.then(function(pdf) {
                const rotateDegrees = document.getElementById('rotate-degrees') ? 
                    document.getElementById('rotate-degrees').value : '90';
                const rotatePages = document.getElementById('rotate-pages') ? 
                    document.getElementById('rotate-pages').value : 'All pages';
                
                resultArea.innerHTML = `
                    <h3>Rotate Pages</h3>
                    <p>Your PDF has ${pdf.numPages} pages.</p>
                    <p>Rotation: ${rotateDegrees}째</p>
                    <p>Pages to rotate: ${rotatePages}</p>
                    <p>In a complete implementation, this would rotate the specified pages by the selected angle.</p>
                    <p><strong>Note:</strong> Actual page rotation requires modifying the page rotation 
                    properties in the PDF, which would need additional implementation using PDF.js.</p>
                    <button class="btn btn-primary" onclick="resetTool()">Process Another PDF</button>
                `;
            }).catch(function(error) {
                console.error('Error loading PDF:', error);
                resultArea.innerHTML = `
                    <h3>Error</h3>
                    <p>There was an error processing your PDF: ${error.message}</p>
                    <button class="btn btn-primary" onclick="resetTool()">Try Again</button>
                `;
            });
        }
        
        // Add watermark function
        function processWatermarkPDF(typedarray) {
            // Load the PDF document
            pdfjsLib.getDocument(typedarray).promise.then(function(pdf) {
                const watermarkText = document.getElementById('watermark-text') ? 
                    document.getElementById('watermark-text').value : 'WATERMARK';
                const watermarkOpacity = document.getElementById('watermark-opacity') ? 
                    document.getElementById('watermark-opacity').value : '0.5';
                
                resultArea.innerHTML = `
                    <h3>Add Watermark</h3>
                    <p>Your PDF has ${pdf.numPages} pages.</p>
                    <p>Watermark text: ${watermarkText}</p>
                    <p>Opacity: ${watermarkOpacity}</p>
                    <p>In a complete implementation, this would add the specified watermark text 
                    to each page of your PDF with the selected opacity.</p>
                    <p><strong>Note:</strong> Adding watermarks requires modifying each page's content 
                    stream to include the watermark text, which would need additional implementation.</p>
                    <button class="btn btn-primary" onclick="resetTool()">Process Another PDF</button>
                `;
            }).catch(function(error) {
                console.error('Error loading PDF:', error);
                resultArea.innerHTML = `
                    <h3>Error</h3>
                    <p>There was an error processing your PDF: ${error.message}</p>
                    <button class="btn btn-primary" onclick="resetTool()">Try Again</button>
                `;
            });
        }
    </script>
    
    <style>
        .pdf-tools-container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .tool-selector {
            margin-bottom: 20px;
        }
        
        .tool-selector label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        
        .tool-description {
            margin-bottom: 20px;
            padding: 10px;
            background-color: #e9f7fe;
            border-left: 4px solid #007acc;
            border-radius: 4px;
        }
        
        .file-drop-area {
            border: 2px dashed #ccc;
            border-radius: 8px;
            padding: 40px;
            text-align: center;
            margin-bottom: 20px;
            cursor: pointer;
            transition: border-color 0.3s;
        }
        
        .file-drop-area:hover {
            border-color: #007acc;
        }
        
        .file-drop-area p {
            margin-bottom: 20px;
        }
        
        #file-input {
            display: none;
        }
        
        .file-list {
            margin-bottom: 20px;
        }
        
        .file-item {
            padding: 10px;
            border-bottom: 1px solid #eee;
            display: flex;
            justify-content: space-between;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        
        .form-control {
            width: 100%;
            padding: 8px;
            border: 1px solid #ccc;
            border-radius: 4px;
        }
        
        .action-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
        }
        
        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
            transition: background-color 0.3s;
        }
        
        .btn-primary {
            background-color: #007acc;
            color: white;
        }
        
        .btn-primary:hover {
            background-color: #005a9e;
        }
        
        .btn-secondary {
            background-color: #6c757d;
            color: white;
        }
        
        .btn-secondary:hover {
            background-color: #545b62;
        }
        
        .result-area {
            margin-top: 30px;
            padding: 20px;
            background-color: #d4edda;
            border: 1px solid #c3e6cb;
            border-radius: 4px;
            text-align: center;
        }
    </style>
</body>
</html>